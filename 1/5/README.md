# fetch(), —Å–æ–±—ã—Ç–∏–µ onsubmit, async/await

## –ó–∞–¥–∞—á–∞

1) –°–¥–µ–ª–∞—Ç—å POST –∑–∞–ø—Ä–æ—Å –ø–æ –∞–¥—Ä–µ—Å—É `https://fakestoreapi.com/products` –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ (submit) —Ñ–æ—Ä–º—ã (–≤ —Ñ–∞–π–ª–µ `index.html`) –≤–º–µ—Å—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Ñ–æ—Ä–º—ã. [–ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –∑–∞–ø—Ä–æ—Å](https://fakestoreapi.com/docs#p-new).

## –ú–∞—Ç–µ—Ä–∏–∞–ª—ã

1) [async/await](https://learn.javascript.ru/async-await)
2) [fetch](https://learn.javascript.ru/fetch)

## –í –∫—Ä–∞—Ç—Ü–µ

### JSON

–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ js - –æ–±—ä–µ–∫—Ç–∞ (—Ä–∞–∑–±–∏—Ä–∞–ª–∏ –≤ sm3). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ –≤—Å–µ–º–∏ —è–∑—ã–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

–ß–∞—Å—Ç–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä—É –º—ã —Ç–æ—á–Ω–æ –Ω–µ –∑–Ω–∞–µ–º, —Å–∫–æ–ª—å–∫–æ –∑–∞–π–º—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –ª–∏ –æ–Ω –≤–æ–æ–±—â–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤ js —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ù–∞–º –Ω—É–∂–Ω—ã –ª–∏—à—å async/await –∏ fetch().

#### async/await

Async –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`async funciton fnName() {}`, `async () => {}`), –∫–æ–¥ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Promise` (–æ–±–µ—â–∞–Ω–∏–µ - –∞–Ω–≥–ª.). –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ, `Promise` - —ç—Ç–æ –Ω–µ—á—Ç–æ –≤—Ä–æ–¥–µ "–ø–æ–¥–æ–∂–¥–∏ –º–µ–Ω—è". –ß—Ç–æ–±—ã –ø–æ–¥–æ–∂–¥–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `await` (–æ–∫, —è —Ç–µ–±—è –ø–æ–¥–æ–∂–¥—É).

#### fetch()

–û—á–µ–Ω—å —É–¥–æ–±–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä—É.

```js
fetch(–∞–¥—Ä–µ—Å –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –¥–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å, {(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)–æ–±—ä–µ–∫—Ç —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏})
```

–ù–∏–∂–µ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∏ fetch().

```js
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async function getProducts() {
  // –ó–∞—Ä–ø–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ fetch()
  const response = await fetch('https://test.com/api/products');
  // –ë–µ—Ä—ë–º json –æ—Ç–≤–µ—Ç –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
  const products = await response.json(); 
  // –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  console.log(await products);
}
```

### –ë—Ä–∞—É–∑–µ—Ä–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ onsubmit

–ö–æ–≥–¥–∞ –º—ã –¥–µ–ª–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã, —Ç–æ —É —ç–ª–µ–º–µ–Ω—Ç–∞ `<form>`, –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ `onsubmit`. –í —ç—Ç–æ–º —Å–æ–±—ã—Ç–∏–∏ –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ—é –æ–±—Ä–∞–±–æ—Ç–∫—É (–≤ —Ç.—á. –∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã).

```html
<form id="addProduct" onsubmit="createProduct(event)">
  <input type="text" name="title" placeholder="title">
  <input type="text" name="price" placeholder="price">
  <input type="text" name="description" placeholder="description">
  <button type="submit">Add product</button>
</form>

<script>
  // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç —Ñ–æ—Ä–º—ã
  const createProductForm = document.querySelector('#addProduct');

  // –°–æ–∑–¥–∞—ë–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å–æ–±—ã—Ç–∏—é onsubmit
  async function createProduct(event) {
    // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —á—Ç–æ–±—ã —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã
    event.preventDefault();
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º try {} catch() {}, —á—Ç–æ–±—ã –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–∑ try {} –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏—Ö –≤ catch{}
    try {
      // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å
      const call = await fetch('https://fakestoreapi.com/products', {
        // –°—Ç–∞–≤–∏–º –º–µ—Ç–æ–¥ POST
        method: "POST",
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON.stringify() –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç json –æ–±—ä–µ–∫—Ç –≤ —Å—Ç—Ä–æ–∫—É)
        body: JSON.stringify(
          {
            // –î–∞–ª–µ–µ –¥–æ—Å—Ç–∞—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∏–Ω–ø—É—Ç–æ–≤ —Ñ–æ—Ä–º—ã –ø–æ–¥–æ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ –Ω–∏–º –ø–æ –∏–º–µ–Ω–∏
            title: createProductForm.title.value,
            price: createProductForm.price.value,
            description: createProductForm.description.value,
            image: 'https://i.pravatar.cc',
            category: 'electronic'
          }
        )
      });
      // –î–æ—Å—Ç–∞—ë–º json –∏–∑ –æ—Ç–≤–µ—Ç–∞
      const response = await call.json();
    } catch (error) {
      // –ï—Å–ª–∏ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ (–≤—Å–µ –∫–æ–¥—ã HTTP –æ—Ç–≤–µ—Ç–∞, –∫—Ä–æ–º–µ 200 - 299)
      alert('üö® –û—à–∏–±–∫–∞: ', error);
      // –ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
      return;
    } 
    // –í—ã–≤–æ–¥–∏–º –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –µ—Å–ª–∏ –≤—Å—ë –æ–∫
    console.log(await response);
  } 
</script>
```